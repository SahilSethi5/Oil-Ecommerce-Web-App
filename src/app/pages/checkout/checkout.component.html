<div class="container mt-4">
    <h1>Checkout</h1>
    
    <div class="row mt-4" *ngIf="cartItems.length > 0">
      <div class="col-lg-8">
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Customer Information</h5>
            
            <form [formGroup]="checkoutForm" (ngSubmit)="placeOrder()">
              <div formGroupName="customerInfo">
                <div class="mb-3">
                  <label for="name" class="form-label">Full Name</label>
                  <input type="text" class="form-control" id="name" formControlName="name" required>
                  <div class="text-danger small" *ngIf="checkoutForm.get('customerInfo.name')?.invalid && checkoutForm.get('customerInfo.name')?.touched">
                    Please enter your full name.
                  </div>
                </div>
                
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" class="form-control" id="email" formControlName="email" required>
                    <div class="text-danger small" *ngIf="checkoutForm.get('customerInfo.email')?.invalid && checkoutForm.get('customerInfo.email')?.touched">
                      Please enter a valid email address.
                    </div>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <label for="phone" class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="phone" formControlName="phone" required>
                    <div class="text-danger small" *ngIf="checkoutForm.get('customerInfo.phone')?.invalid && checkoutForm.get('customerInfo.phone')?.touched">
                      Please enter your phone number.
                    </div>
                  </div>
                </div>
                
                <h6 class="mt-4">Shipping Address</h6>
                
                <div formGroupName="address">
                  <div class="mb-3">
                    <label for="street" class="form-label">Street Address</label>
                    <input type="text" class="form-control" id="street" formControlName="street" required>
                  </div>
                  
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label for="city" class="form-label">City</label>
                      <input type="text" class="form-control" id="city" formControlName="city" required>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                      <label for="state" class="form-label">State/Province</label>
                      <input type="text" class="form-control" id="state" formControlName="state" required>
                    </div>
                  </div>
                  
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label for="zipCode" class="form-label">ZIP/Postal Code</label>
                      <input type="text" class="form-control" id="zipCode" formControlName="zipCode" required>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                      <label for="country" class="form-label">Country</label>
                      <input type="text" class="form-control" id="country" formControlName="country" required>
                    </div>
                  </div>
                </div>
              </div>
              
              <h5 class="card-title mt-4">Payment Method</h5>
              
              <div class="mb-3">
                <div class="form-check">
                  <input class="form-check-input" type="radio" formControlName="paymentMethod" id="cashOnDelivery" value="cashOnDelivery" checked>
                  <label class="form-check-label" for="cashOnDelivery">
                    Cash on Delivery
                  </label>
                </div>
              </div>
              
              <div class="d-flex justify-content-between mt-4">
                <a routerLink="/cart" class="btn btn-outline-secondary">
                  Back to Cart
                </a>
                <button type="submit" class="btn btn-primary" [disabled]="checkoutForm.invalid">
                  Place Order
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4">
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Order Summary</h5>
            <hr>
            
            <div class="mb-3">
              <div *ngFor="let item of cartItems" class="d-flex justify-content-between mb-2">
                <span>{{ item.product.name }} Ã— {{ item.quantity }}</span>
                <span>${{ (item.product.price * item.quantity).toFixed(2) }}</span>
              </div>
            </div>
            
            <hr>
            
            <div class="d-flex justify-content-between mb-2">
              <span>Subtotal:</span>
              <span>${{ getSubtotal().toFixed(2) }}</span>
            </div>
            
            <div class="d-flex justify-content-between mb-2">
              <span>Shipping:</span>
              <span>{{ getShipping() === 0 ? 'Free' : '$' + getShipping().toFixed(2) }}</span>
            </div>
            
            <div class="d-flex justify-content-between mb-2">
              <span>Tax (7%):</span>
              <span>${{ getTax().toFixed(2) }}</span>
            </div>
            
            <hr>
            
            <div class="d-flex justify-content-between mb-2 fw-bold">
              <span>Total:</span>
              <span>${{ getTotal().toFixed(2) }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="text-center py-5" *ngIf="cartItems.length === 0">
      <div class="py-5">
        <i class="bi bi-cart-x fs-1 text-muted"></i>
        <h3 class="mt-3">Your cart is empty</h3>
        <p class="text-muted">You need to add products to your cart before checkout.</p>
        <a routerLink="/products" class="btn btn-primary mt-3">
          Browse Products
        </a>
      </div>
    </div>
  </div>